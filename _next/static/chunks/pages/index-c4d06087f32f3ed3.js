(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,n,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return l(9181)}])},9181:function(e,n,l){"use strict";l.r(n),l.d(n,{default:function(){return R}});var i=l(5893),t=l(7294),s=l(8901),r=l(815),a=l(3321),d=l(2963),c=l(4599),o=l(5378),u=l(1768),x=l(2280),h=l(8895),m=l(7357),j=l(2797),p=l(3665);let f=["luma709","luma601","maximum","minimum","average","minmax","red","green","blue","cyan","magenta","yellow","black","hue","saturation","lightness"];function g(e){let{image:n,onUpdate:l}=e;return(0,i.jsxs)(x.Z,{disabled:!n,children:[(0,i.jsx)(h.Z,{children:(0,i.jsxs)(m.Z,{sx:{display:"flex",fontWeight:"bold",alignItems:"center",justifyContent:"center",gap:"0.25em"},children:[(0,i.jsx)(p.Z,{}),(0,i.jsx)("span",{children:"Grey Scale"})]})}),(0,i.jsx)(j.Z,{children:f.map(e=>(0,i.jsx)(a.Z,{onClick:()=>l("grey",{algorithm:e}),children:e},e))})]})}var v=l(3330),y=l(5819),Z=l(5861),b=l(5929),C=l(5522);function k(e){let{type:n,value:l,checked:i}=e;switch(n){case"checkbox":return i;case"range":case"number":return+(l||0);default:return l}}function w(e){let{image:n,onUpdate:l}=e,s=(0,t.useRef)(null),r=(0,t.useCallback)(()=>{if(!s.current)return null;setTimeout(()=>{let e=Object.fromEntries(Array.from(null==s?void 0:s.current.querySelectorAll("input").values()).map(e=>[e.name,k(e)])),n={radius:e.radius,sigma:e.sigma};l(e.operation,n)})},[]);return(0,i.jsxs)(x.Z,{disabled:!n,children:[(0,i.jsx)(h.Z,{children:(0,i.jsxs)(m.Z,{sx:{display:"flex",fontWeight:"bold",alignItems:"center",justifyContent:"center",gap:"0.25em"},children:[(0,i.jsx)(C.Z,{}),(0,i.jsx)("span",{children:"Blur Filter"})]})}),(0,i.jsx)(j.Z,{children:(0,i.jsxs)("form",{ref:s,children:[(0,i.jsxs)(v.Z,{name:"operation",label:"operation",defaultValue:"gaussianFilter",children:[(0,i.jsx)(y.Z,{value:"medianFilter",children:"Median Filter"}),(0,i.jsx)(y.Z,{value:"gaussianFilter",children:"Gaussian Filter"})]}),(0,i.jsxs)(m.Z,{display:"flex",gap:5,children:[(0,i.jsx)(Z.Z,{children:" Radius "}),(0,i.jsx)(b.ZP,{name:"radius",min:1,max:100,step:1,onChange:r})]}),(0,i.jsxs)(m.Z,{display:"flex",gap:5,children:[(0,i.jsx)(Z.Z,{children:" Sigma "}),(0,i.jsx)(b.ZP,{name:"sigma",min:.01,max:100,step:.01,onChange:r})]})]})})]})}var E=l(4422);function S(e){let{image:n,onUpdate:l}=e,s=(0,t.useRef)(null),r=(0,t.useCallback)(()=>{if(!s.current)return null;setTimeout(()=>{let e=Object.fromEntries(Array.from(null==s?void 0:s.current.querySelectorAll("input").values()).map(e=>[e.name,k(e)])),{operation:n,...i}=e;l(n,i)})},[]);return(0,i.jsxs)(x.Z,{disabled:!n||n.components>1,children:[(0,i.jsx)(h.Z,{children:(0,i.jsxs)(m.Z,{sx:{display:"flex",fontWeight:"bold",alignItems:"center",justifyContent:"center",gap:"0.25em"},children:[(0,i.jsx)(E.Z,{}),(0,i.jsx)("span",{children:" Erode/Dilate"})]})}),(0,i.jsx)(j.Z,{children:(0,i.jsxs)("form",{ref:s,children:[(0,i.jsxs)(v.Z,{name:"operation",label:"operation",defaultValue:"erode",children:[(0,i.jsx)(y.Z,{value:"erode",children:"Erode"}),(0,i.jsx)(y.Z,{value:"dilate",children:"Dilate"}),(0,i.jsx)(y.Z,{value:"open",children:"Open (Dilate + Erode)"}),(0,i.jsx)(y.Z,{value:"open",children:"Close (Erode + Dilate)"}),(0,i.jsx)(y.Z,{value:"blackHat",children:"Black Hat"}),(0,i.jsx)(y.Z,{value:"topHat",children:"White Hat"})]}),(0,i.jsxs)(m.Z,{display:"flex",gap:5,children:[(0,i.jsx)(Z.Z,{children:" Iterations "}),(0,i.jsx)(b.ZP,{name:"iterations",min:1,max:100,step:1,onChange:r})]})]})})]})}var D=l(281);function F(e){let{image:n,onUpdate:l}=e,s=(0,t.useRef)(null),r=(0,t.useCallback)(()=>{if(!s.current)return null;setTimeout(()=>{let e=Object.fromEntries(Array.from(null==s?void 0:s.current.querySelectorAll("input").values()).map(e=>[e.name,k(e)])),{operation:n,...i}=e,[t,r]=n.split("-");l(t,{...i,direction:r})})},[]);return(0,i.jsxs)(x.Z,{disabled:!n,children:[(0,i.jsx)(h.Z,{children:(0,i.jsxs)(m.Z,{sx:{display:"flex",fontWeight:"bold",alignItems:"center",justifyContent:"center",gap:"0.25em"},children:[(0,i.jsx)(D.Z,{}),(0,i.jsx)("span",{children:" Edge Detection "})]})}),(0,i.jsx)(j.Z,{children:(0,i.jsxs)("form",{ref:s,children:[(0,i.jsxs)(v.Z,{name:"operation",label:"operation",defaultValue:"sobelFilter-xy",children:[(0,i.jsx)(y.Z,{value:"cannyEdge",disabled:(null==n?void 0:n.components)>1,children:"Canny Edge"}),(0,i.jsx)(y.Z,{value:"morphologicalGradient",disabled:(null==n?void 0:n.components)>1,children:"Morphological Gradient"}),(0,i.jsx)(y.Z,{value:"sobelFilter-x",children:"Sobel X"}),(0,i.jsx)(y.Z,{value:"sobelFilter-y",children:"Sobel Y"}),(0,i.jsx)(y.Z,{value:"sobelFilter-xy",children:"Sobel XY"})]}),(0,i.jsx)(a.Z,{onClick:r,children:"Run"})]})})]})}function _(e){return(0,i.jsxs)("div",{children:[(0,i.jsx)(g,{...e}),(0,i.jsx)(w,{...e}),(0,i.jsx)(S,{...e}),(0,i.jsx)(F,{...e})]})}function I(e){let{operation:n,data:l,...t}=e;return n?(0,i.jsxs)(a.Z,{...t,children:[n,"(",JSON.stringify(l||{}),")"]}):null}function T(){var e,n,l,x,h,m,j,p,f;let[g,v]=(0,t.useState)(0),[y,Z]=(0,t.useState)([]),[b,C]=(0,t.useState)(1),[[k,w],E]=(0,t.useState)([0,0]),S=(0,t.useRef)(null),[D,F]=(0,t.useState)(null),T=(0,t.useCallback)(async e=>{let[n]=e,l=await r.Ee.load(await n.arrayBuffer());Z(e=>[...e,{type:"fs",name:n.name,chain:[{parent:null,id:e.length,operation:"fs",data:{input:n.name}}],image:l,thumbnail:l.width>300?l.resize({width:300}):l}])},[]),{getRootProps:R,getInputProps:M,isDragActive:N}=(0,s.uI)({onDrop:T}),O=(0,t.useCallback)((e,n)=>{Z(l=>{console.log({selected:g});try{var i;return null===(i=l[g])||void 0===i||i.image[e](n),l[g],[...l.slice(0,g),...l.slice(g+1)]}catch(e){return console.error(e),l}})},[g]),A=(null===(n=y[g])||void 0===n?void 0:null===(e=n.next)||void 0===e?void 0:e.image)||(null===(l=y[g])||void 0===l?void 0:l.image),W=(0,t.useMemo)(()=>null==A?void 0:A.toDataURL(),[A,null===(x=y[g])||void 0===x?void 0:x.next]);return(0,i.jsxs)("div",{style:{display:"flex",height:"100%",flexDirection:"column",justifyContent:"stretch",alignItems:"flex-start",maxHeight:"1vh"},children:[(0,i.jsxs)("div",{className:"topBar",style:{display:"flex",height:"2rem",gap:"0.1em",alignItems:"center"},children:[(0,i.jsx)(a.Z,{disabled:!(null===(h=y[g])||void 0===h?void 0:h.next),onClick:()=>Z(e=>(delete e[g].next,[...e])),children:(0,i.jsx)(o.Z,{})}),(0,i.jsx)(a.Z,{disabled:!(null===(m=y[g])||void 0===m?void 0:m.next),onClick:()=>{Z(e=>{let{image:n,operation:l,data:i}=e[g].next;return delete e[g].next,setTimeout(()=>{console.log("updating selection",g,e.length),v(e.length)}),[...e,{type:"op",name:l,chain:[...e[g].chain,{parent:g,id:e.length,operation:l,data:i}],image:n,thumbnail:n.width>300?n.resize({width:300}):n}]})},children:(0,i.jsx)(u.Z,{})}),A&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("span",{children:[" ",null==A?void 0:A.width," "]}),(0,i.jsx)("span",{children:" x "}),(0,i.jsxs)("span",{children:[" ",null==A?void 0:A.height," "]})]}),(0,i.jsxs)(d.Z,{separator:">",sx:{marginLeft:"1em"},children:[(null===(j=y[g])||void 0===j?void 0:j.chain.length)>5&&(0,i.jsx)("span",{children:"..."}),null===(p=y[g])||void 0===p?void 0:p.chain.slice(-5).map((e,n)=>(0,i.jsx)(I,{onClick:()=>{v(e.id)},style:{color:"#ccc"},...e},n)),(0,i.jsx)(I,{style:{color:"#333"},...null===(f=y[g])||void 0===f?void 0:f.next})]})]}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"minmax(0px, 20em) 1fr minmax(0px, 20em)",gridTemplateRows:"1fr"},children:[(0,i.jsxs)("div",{style:{background:"#eee",overflowY:"scroll",height:"calc(100vh - 3rem)"},children:[(0,i.jsx)("input",{...M()}),(0,i.jsx)("div",{style:{width:"15em"},children:y.map((e,n)=>(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",padding:"0.5em",margin:"0.5em",border:"solid 1px ".concat(n==g?"red":"black"),justifyContent:"center",alignItems:"center"},children:[(0,i.jsx)("img",{style:{width:"fs"==e.type?"100%":"90%"},src:e.thumbnail.toDataURL(),onClick:()=>{v(n)}},e.name),(0,i.jsx)("span",{children:e.name})]},e.name+n))}),(0,i.jsx)("div",{...R(),style:{marginTop:"2em"},children:(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[(0,i.jsx)(c.Z,{style:{width:"5rem",height:"5rem"}}),(0,i.jsx)("span",{children:"add Image"})]})})]}),A&&(0,i.jsx)("div",{ref:S,draggable:!1,style:{userSelect:"none",display:"flex",padding:"1em",background:"#ccc",overflow:"hidden",position:"relative"},onMouseDown:e=>{if(!S.current)return;let n=e.clientX,l=e.clientY;F([n,l,k,w])},onMouseMove:e=>{if(!D||!S.current)return;let n=e.clientX-D[0],l=e.clientY-D[1];E([n+D[2],l+D[3]])},onMouseUp:()=>F(null),onMouseLeave:()=>F(null),onClick:()=>F(null),onBlur:()=>F(null),onWheel:e=>{C(b+e.deltaY/1e3)},children:(0,i.jsx)("img",{draggable:!1,style:{userSelect:"none",transform:"translate(".concat(k,"px, ").concat(w,"px) scale(").concat(b,")"),objectFit:"contain"},src:W})}),(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1em"},children:[(0,i.jsx)("h2",{children:"Tools"}),(0,i.jsx)(_,{image:A,onUpdate:(e,n)=>{O(e,n)}},g)]})]})]})}function R(){return(0,i.jsx)(T,{})}}},function(e){e.O(0,[655,273,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);