(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,n,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return l(1087)}])},1087:function(e,n,l){"use strict";l.r(n),l.d(n,{default:function(){return Y}});var i=l(5893),t=l(7294),s=l(8901),r=l(815),a=l(3321),d=l(2963),c=l(5378),o=l(1768),u=l(2280),x=l(8895),h=l(7357),j=l(2797),m=l(4721),p=l(5512),g=l(6895),f=l(5498),v=l(0),Z=l(2014),y=l(3665);let b=["luma709","luma601","maximum","minimum","average","minmax","red","green","blue","cyan","magenta","yellow","black","hue","saturation","lightness"];function k(e){let{image:n,onUpdate:l}=e;return(0,i.jsxs)(u.Z,{disabled:!n,children:[(0,i.jsx)(x.Z,{children:(0,i.jsxs)(h.Z,{sx:{display:"flex",fontWeight:"bold",alignItems:"center",justifyContent:"center",gap:"0.25em"},children:[(0,i.jsx)(y.Z,{}),(0,i.jsx)("span",{children:"Grey Scale"})]})}),(0,i.jsx)(j.Z,{children:b.map(e=>(0,i.jsx)(a.Z,{onClick:()=>l("grey",{algorithm:e}),children:e},e))})]})}var w=l(3330),C=l(5819),S=l(5861),E=l(5929),I=l(5522);function F(e){let{type:n,value:l,checked:i}=e;switch(n){case"checkbox":return i;case"range":case"number":return+(l||0);default:return l}}function A(e){let{image:n,onUpdate:l}=e,s=(0,t.useRef)(null),r=(0,t.useCallback)(()=>{if(!s.current)return null;setTimeout(()=>{let e=Object.fromEntries(Array.from(null==s?void 0:s.current.querySelectorAll("input").values()).map(e=>[e.name,F(e)])),n={radius:e.radius,sigma:e.sigma};l(e.operation,n)})},[]);return(0,i.jsxs)(u.Z,{disabled:!n,children:[(0,i.jsx)(x.Z,{children:(0,i.jsxs)(h.Z,{sx:{display:"flex",fontWeight:"bold",alignItems:"center",justifyContent:"center",gap:"0.25em"},children:[(0,i.jsx)(I.Z,{}),(0,i.jsx)("span",{children:"Blur Filter"})]})}),(0,i.jsx)(j.Z,{children:(0,i.jsxs)("form",{ref:s,children:[(0,i.jsxs)(w.Z,{name:"operation",label:"operation",defaultValue:"gaussianFilter",children:[(0,i.jsx)(C.Z,{value:"medianFilter",children:"Median Filter"}),(0,i.jsx)(C.Z,{value:"gaussianFilter",children:"Gaussian Filter"})]}),(0,i.jsxs)(h.Z,{display:"flex",gap:5,children:[(0,i.jsx)(S.Z,{children:" Radius "}),(0,i.jsx)(E.ZP,{name:"radius",min:1,max:100,step:1,onChange:r})]}),(0,i.jsxs)(h.Z,{display:"flex",gap:5,children:[(0,i.jsx)(S.Z,{children:" Sigma "}),(0,i.jsx)(E.ZP,{name:"sigma",min:.01,max:100,step:.01,onChange:r})]})]})})]})}var D=l(4422);function O(e){let{image:n,onUpdate:l}=e,s=(0,t.useRef)(null),r=(0,t.useCallback)(()=>{if(!s.current)return null;setTimeout(()=>{let e=Object.fromEntries(Array.from(null==s?void 0:s.current.querySelectorAll("input").values()).map(e=>[e.name,F(e)])),{operation:n,...i}=e;l(n,i)})},[]);return(0,i.jsxs)(u.Z,{disabled:!n||n.components>1,children:[(0,i.jsx)(x.Z,{children:(0,i.jsxs)(h.Z,{sx:{display:"flex",fontWeight:"bold",alignItems:"center",justifyContent:"center",gap:"0.25em"},children:[(0,i.jsx)(D.Z,{}),(0,i.jsx)("span",{children:" Erode/Dilate"})]})}),(0,i.jsx)(j.Z,{children:(0,i.jsxs)("form",{ref:s,children:[(0,i.jsxs)(w.Z,{name:"operation",label:"operation",defaultValue:"erode",children:[(0,i.jsx)(C.Z,{value:"erode",children:"Erode"}),(0,i.jsx)(C.Z,{value:"dilate",children:"Dilate"}),(0,i.jsx)(C.Z,{value:"open",children:"Open (Dilate + Erode)"}),(0,i.jsx)(C.Z,{value:"open",children:"Close (Erode + Dilate)"}),(0,i.jsx)(C.Z,{value:"blackHat",children:"Black Hat"}),(0,i.jsx)(C.Z,{value:"topHat",children:"White Hat"})]}),(0,i.jsxs)(h.Z,{display:"flex",gap:5,children:[(0,i.jsx)(S.Z,{children:" Iterations "}),(0,i.jsx)(E.ZP,{name:"iterations",min:1,max:100,step:1,onChange:r})]})]})})]})}var _=l(281);function R(e){let{image:n,onUpdate:l}=e,s=(0,t.useRef)(null),r=(0,t.useCallback)(()=>{if(!s.current)return null;setTimeout(()=>{let e=Object.fromEntries(Array.from(null==s?void 0:s.current.querySelectorAll("input").values()).map(e=>[e.name,F(e)])),{operation:n,...i}=e,[t,r]=n.split("-");l(t,{...i,direction:r})})},[]);return(0,i.jsxs)(u.Z,{disabled:!n,children:[(0,i.jsx)(x.Z,{children:(0,i.jsxs)(h.Z,{sx:{display:"flex",fontWeight:"bold",alignItems:"center",justifyContent:"center",gap:"0.25em"},children:[(0,i.jsx)(_.Z,{}),(0,i.jsx)("span",{children:" Edge Detection "})]})}),(0,i.jsx)(j.Z,{children:(0,i.jsxs)("form",{ref:s,children:[(0,i.jsxs)(w.Z,{name:"operation",label:"operation",defaultValue:"sobelFilter-xy",children:[(0,i.jsx)(C.Z,{value:"cannyEdge",disabled:(null==n?void 0:n.components)>1,children:"Canny Edge"}),(0,i.jsx)(C.Z,{value:"morphologicalGradient",disabled:(null==n?void 0:n.components)>1,children:"Morphological Gradient"}),(0,i.jsx)(C.Z,{value:"sobelFilter-x",children:"Sobel X"}),(0,i.jsx)(C.Z,{value:"sobelFilter-y",children:"Sobel Y"}),(0,i.jsx)(C.Z,{value:"sobelFilter-xy",children:"Sobel XY"})]}),(0,i.jsx)(a.Z,{onClick:r,children:"Run"})]})})]})}function M(e){return(0,i.jsxs)("div",{children:[(0,i.jsx)(k,{...e}),(0,i.jsx)(A,{...e}),(0,i.jsx)(O,{...e}),(0,i.jsx)(R,{...e})]})}var P=l(4599);function T(e){let{image:n}=e,[l,s]=(0,t.useState)({}),r=(null==n?void 0:n.width)*(null==n?void 0:n.height);return(0,i.jsxs)("div",{children:[(0,i.jsx)(a.Z,{onClick:()=>{let e={};for(let[l,i,t,s]of n.getPixelsArray()){let r=1==n.components,a=r?"rgb(".concat(l,",").concat(l,",").concat(l,")"):"rgba(".concat(l||0,",").concat(i||0,",").concat(t||0,",").concat(s||1,")");e[a]=e[a]||0,e[a]+=1}s(e)},children:" Histogram"}),(0,i.jsx)("div",{style:{overflowY:"scroll",height:"200px"},children:Object.entries(l).filter(e=>{let[n,l]=e;return l>.001*r}).sort((e,n)=>n[1]-e[1]).map(e=>{let[n,l]=e;return(0,i.jsxs)("div",{style:{display:"flex"},children:[(0,i.jsx)("span",{style:{background:n,width:"1em",height:"1em",display:"block"}}),(0,i.jsxs)("span",{children:[n," = "]}),(0,i.jsxs)("span",{children:[" ",(l/r*100).toFixed(3),"% (",l,") "]})]},n)})})]})}function L(e){var n,l;let{selected:t,setSelected:s,images:r,onAddFiles:a,update:d}=e,c=null===(n=r[t])||void 0===n?void 0:n.image;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(u.Z,{TransitionProps:{unmountOnExit:!0},children:[(0,i.jsx)(x.Z,{children:(0,i.jsxs)(h.Z,{style:{display:"flex",alignItems:"center",gap:"0.5em"},children:[(0,i.jsx)(m.Z,{})," Info"]})}),(0,i.jsx)(j.Z,{children:(0,i.jsx)("pre",{children:(0,i.jsx)("code",{children:JSON.stringify({name:null===(l=r[t])||void 0===l?void 0:l.name,meta:null==c?void 0:c.meta,width:null==c?void 0:c.width,height:null==c?void 0:c.height,size:null==c?void 0:c.size,bitDepth:null==c?void 0:c.bitDepth,maxValue:null==c?void 0:c.maxValue,channels:null==c?void 0:c.channels,colorModel:null==c?void 0:c.colorModel},null,2)})})})]}),(0,i.jsxs)(u.Z,{children:[(0,i.jsx)(x.Z,{children:(0,i.jsxs)(h.Z,{style:{display:"flex",alignItems:"center",gap:"0.5em"},children:[(0,i.jsx)(g.Z,{})," Processing"]})}),(0,i.jsx)(j.Z,{children:(0,i.jsx)(M,{image:c,onUpdate:(e,n)=>{d(e,n)}},t)})]}),(0,i.jsxs)(u.Z,{children:[(0,i.jsx)(x.Z,{children:(0,i.jsxs)(h.Z,{style:{display:"flex",alignItems:"center",gap:"0.5em"},children:[(0,i.jsx)(f.Z,{})," Analyze"]})}),(0,i.jsx)(j.Z,{children:(0,i.jsx)(T,{image:c},t)})]}),(0,i.jsxs)(u.Z,{children:[(0,i.jsx)(x.Z,{children:(0,i.jsxs)(h.Z,{style:{display:"flex",alignItems:"center",gap:"0.5em"},children:[(0,i.jsx)(p.Z,{})," Files"]})}),(0,i.jsxs)(j.Z,{children:[(0,i.jsx)("div",{children:r.map((e,n)=>(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",padding:"0.5em",margin:"0.5em",border:"solid 1px ".concat(n==t?"red":"black"),justifyContent:"center",alignItems:"center"},children:[(0,i.jsx)("img",{style:{width:"fs"==e.type?"100%":"90%"},src:e.thumbnail.toDataURL(),onClick:()=>{s(n)}},e.name),(0,i.jsx)("span",{children:e.name})]},e.name+n))}),(0,i.jsx)("div",{style:{marginTop:"2em"},onClick:a,children:(0,i.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[(0,i.jsx)(P.Z,{style:{width:"5rem",height:"5rem"}}),(0,i.jsx)("span",{children:"add Image"})]})})]})]}),(0,i.jsxs)(u.Z,{children:[(0,i.jsx)(x.Z,{children:(0,i.jsxs)(h.Z,{style:{display:"flex",alignItems:"center",gap:"0.5em"},children:[(0,i.jsx)(v.Z,{})," Workflows"]})}),(0,i.jsx)(j.Z,{})]}),(0,i.jsxs)(u.Z,{children:[(0,i.jsx)(x.Z,{children:(0,i.jsxs)(h.Z,{style:{display:"flex",alignItems:"center",gap:"0.5em"},children:[(0,i.jsx)(Z.Z,{})," Export"]})}),(0,i.jsx)(j.Z,{})]})]})}function N(e){let{image:n}=e,l=(0,t.useRef)(null),[s,r]=(0,t.useState)(null),[a,d]=(0,t.useState)(1),[[c,o],u]=(0,t.useState)([0,0]);(0,t.useEffect)(()=>(n&&n.toBlob().then(e=>{r(window.URL.createObjectURL(e))}),()=>{s&&window.URL.revokeObjectURL(s)}),[n]);let[x,h]=(0,t.useState)(null);return(0,i.jsx)("div",{ref:l,draggable:!1,style:{gridArea:"c",userSelect:"none",display:"flex",padding:"1em",background:"#eee",overflow:"hidden",position:"relative"},onMouseDown:e=>{if(!l.current)return;let n=e.clientX,i=e.clientY;h([n,i,c,o])},onMouseMove:e=>{if(!x||!l.current)return;let n=e.clientX-x[0],i=e.clientY-x[1];u([n+x[2],i+x[3]])},onMouseUp:()=>h(null),onMouseLeave:()=>h(null),onClick:()=>h(null),onBlur:()=>h(null),onWheel:e=>{d(a+e.deltaY/1e3)},children:(0,i.jsx)("div",{style:{display:"block",position:"absolute",top:"-1000px",left:"-1000px",paddingLeft:"1000px",paddingTop:"1000px",right:"-1000px",bottom:"-1000px",backgroundPosition:"center center",backgroundSize:"20px 20px",transform:"translate(".concat(c,"px, ").concat(o,"px) scale(").concat(a,")"),backgroundImage:"\n              radial-gradient(circle, #000000 1px, rgba(0, 0, 0, 0) 1px),\n              linear-gradient(to right, #ccc 1px, transparent 1px),\n              linear-gradient(to bottom, #ccc 1px, transparent 1px)\n          "},children:s&&(0,i.jsx)("img",{draggable:!1,style:{userSelect:"none",objectFit:"contain"},src:s})})})}function U(e){let{operation:n,data:l,...t}=e;return n?(0,i.jsxs)(a.Z,{...t,children:[n,"(",JSON.stringify(l||{}),")"]}):null}function W(){var e,n,l,u,x,h,j,m;let[p,g]=(0,t.useState)(0),[f,v]=(0,t.useState)([]),Z=(0,t.useCallback)(async e=>{let[n]=e,l=await r.Ee.load(await n.arrayBuffer());v(e=>[...e,{type:"fs",name:n.name,chain:[{parent:null,id:e.length,operation:"fs",data:{input:n.name}}],image:l,thumbnail:l.width>300?l.resize({width:300}):l}])},[]),{getRootProps:y,getInputProps:b,isDragActive:k}=(0,s.uI)({onDrop:Z}),w=(0,t.useCallback)((e,n)=>{v(l=>{console.log({selected:p});try{var i;let t=null===(i=l[p])||void 0===i?void 0:i.image[e](n),s={...l[p],next:{id:p,operation:e,data:n,image:t}};return[...l.slice(0,p),s,...l.slice(p+1)]}catch(e){return console.error(e),l}})},[p]),C=(null===(n=f[p])||void 0===n?void 0:null===(e=n.next)||void 0===e?void 0:e.image)||(null===(l=f[p])||void 0===l?void 0:l.image),{onClick:S,...E}=y();return(0,i.jsxs)("div",{...E,style:{display:"grid",height:"100vh",grid:'\n        [r1-start]  " n   n"    2em [r1-end]\n        [r2-start]  " c   r"    1fr [r1-end]\n                 /   1fr 20em  \n      '},children:[(0,i.jsx)("input",{...b()}),(0,i.jsxs)("div",{className:"topBar",style:{gridArea:"n",display:"flex",height:"2rem",gap:"0.1em",alignItems:"center"},children:[(0,i.jsx)(a.Z,{disabled:!(null===(u=f[p])||void 0===u?void 0:u.next),onClick:()=>v(e=>(delete e[p].next,[...e])),children:(0,i.jsx)(c.Z,{})}),(0,i.jsx)(a.Z,{disabled:!(null===(x=f[p])||void 0===x?void 0:x.next),onClick:()=>{v(e=>{let{image:n,operation:l,data:i}=e[p].next;return delete e[p].next,setTimeout(()=>{console.log("updating selection",p,e.length),g(e.length)}),[...e,{type:"op",name:l,chain:[...e[p].chain,{parent:p,id:e.length,operation:l,data:i}],image:n,thumbnail:n.width>300?n.resize({width:300}):n}]})},children:(0,i.jsx)(o.Z,{})}),C&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("span",{children:[" ",null==C?void 0:C.width," "]}),(0,i.jsx)("span",{children:" x "}),(0,i.jsxs)("span",{children:[" ",null==C?void 0:C.height," "]})]}),(0,i.jsxs)(d.Z,{separator:">",sx:{marginLeft:"1em"},children:[(null===(h=f[p])||void 0===h?void 0:h.chain.length)>5&&(0,i.jsx)("span",{children:"..."}),null===(j=f[p])||void 0===j?void 0:j.chain.slice(-5).map((e,n)=>(0,i.jsx)(U,{onClick:()=>{g(e.id)},style:{color:"#ccc"},...e},n)),(0,i.jsx)(U,{style:{color:"#333"},...null===(m=f[p])||void 0===m?void 0:m.next})]})]}),(0,i.jsx)(N,{image:C}),(0,i.jsx)("div",{style:{gridArea:"r",display:"flex",flexDirection:"column",overflowY:"auto"},children:(0,i.jsx)(L,{images:f,selected:p,setSelected:g,update:w,onAddFiles:S})})]})}function Y(){return(0,i.jsx)(W,{})}}},function(e){e.O(0,[655,144,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);